<?php
$user_id = $_SESSION['user_id'];

//テスト' OR 1=1; SELECT * FROM post;
$trigger = $_POST['trigger'];

$dsn = 'mysql:dbname=vulnerability_demo;host=db';
$user = 'root';
$pass = 'root';

try {
    $dbh = new PDO($dsn, $user, $pass);

    $sql1 = "
    SELECT * FROM post 
    WHERE 
    title = '$trigger'
    ";

    $res = $dbh->query($sql1);
    var_dump($res->fetchALL(PDO::FETCH_ASSOC));

    $sql2 = '
    SELECT * FROM post 
    WHERE 
    title = :trigger
    ';

    $stmt = $dbh->prepare($sql2);
    $param = [
        'trigger' => $trigger
    ];

//    $stmt->execute($param);
//    var_dump($stmt->fetchAll(PDO::FETCH_ASSOC));

    echo 'success';
} catch (PDOException $e) {
    echo 'failed';
}